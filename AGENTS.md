# AGENTS.md

## 系統優化待辦事項（To-Do List）

### 1. LSTM/LLM/策略/Optimizer 串接優化
- [V] 讓 LSTM 預測結果能被所有策略參考（不只 TrendStrategy），可設計為額外特徵或決策因子。
- [V] 強化 LLM prompt，讓 LLM 能根據 LSTM 預測、歷史績效、風險指標等，主動選擇策略與建議參數。
- [V] 讓 LLM 參與 optimizer，或將 optimizer 最佳參數直接傳給 LLM，讓 LLM 決策時能參考最優參數。

### 2. Optimizer 實際作用於主流程
- [V] 優化後的 `best_params` 自動更新到 `param_grids` 或直接用於策略實例化。
- [V] 或將 `best_params` 作為 LLM prompt 的一部分，讓 LLM 決策時能參考。

### 3. 主流程自動化與彈性提升
- [V] 主流程根據 LLM 回傳的「策略名稱」與「參數」自動切換策略與調參。
- [V] 支援 LLM 動態調整資金分配、風控參數等。

### 4. 回測與績效追蹤優化
- [V] 增加更細緻的日誌與報表（如每筆交易原因、策略切換紀錄、參數變動紀錄）。

### 5. LLM Prompt 與回傳格式標準化
- [V] 設計更明確的 LLM prompt，要求回傳「策略選擇」、「參數建議」、「資金分配」、「是否強制交易」等欄位。
- [V] 強化 LLM 回傳格式解析與錯誤處理。

### 6. 風控與保護機制優化
- [ ] 讓 LLM 能根據市場狀態主動建議啟動/解除保護機制（如最大回撤、停損、暫停交易等）。

### 7. main 經簡化
- [ ] 檢查main上的程式碼，該回歸模組的就回歸，增加可讀性與維護性
→ 未完成，近期精簡過程中遇到流程混亂與測試困難，暫時回復細節版 main，待逐步重構。
---

#### 建議優化順序
1. 先讓 optimizer 參數能自動影響主流程（最直接提升績效）。
2. 強化 LLM prompt 與主流程串接，讓 LLM 能主動選策略與調參。
3. 再考慮讓 LSTM 預測成為所有策略的可用特徵。
4. 持續優化日誌、報表與風控。
